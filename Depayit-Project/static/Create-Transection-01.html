<!DOCTYPE html>
<html class="light" lang="th">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Depayit - Create Transaction</title>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&amp;family=Noto+Sans+Thai:wght@300;400;500;600;700&amp;family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#006c75",
                        "primary-dark": "#005a61",
                        "background-light": "#fcfdfd",
                        "background-dark": "#19292e",
                        "surface-light": "#ffffff",
                        "surface-dark": "#23363d",
                        "border-light": "#dae6e7",
                        "border-dark": "#2f454a",
                        "text-main": "#101818",
                        "text-secondary": "#5e898d",
                    },
                    fontFamily: {
                        "display": ['Manrope', 'Noto Sans Thai', 'sans-serif'],
                        "body": ['Manrope', 'Noto Sans Thai', 'sans-serif'],
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem", 
                        "lg": "0.5rem", 
                        "xl": "0.75rem", 
                        "2xl": "1rem",
                        "3xl": "1.5rem",
                        "full": "9999px"
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 108, 117, 0.08)',
                        'float': '0 10px 40px -10px rgba(0, 0, 0, 0.1)',
                    }
                },
            },
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { font-feature-settings: "ss01", "ss02"; min-height: max(884px, 100dvh); }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen font-display antialiased text-text-main selection:bg-primary/20">
    <div class="relative flex h-full min-h-screen w-full max-w-[480px] flex-col bg-background-light dark:bg-background-dark shadow-2xl overflow-hidden sm:rounded-[2rem] sm:h-[90vh] sm:border-[8px] sm:border-gray-900 group/design-root">
        
        <header class="sticky top-0 z-30 flex items-center justify-between bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md px-5 py-4 border-b border-border-light/50 dark:border-border-dark/50">
            <button class="text-text-secondary hover:text-primary transition-colors text-base font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[20px]">close</span>
                <span>ยกเลิก</span>
            </button>
            <h2 class="text-text-main dark:text-white text-lg font-bold tracking-tight">สร้างรายการ</h2>
            <div class="w-[60px] flex justify-end">
                <button class="text-primary hover:text-primary-dark transition-colors">
                    <span class="material-symbols-outlined">help</span>
                </button>
            </div>
        </header>

        <div class="w-full px-6 pt-6 pb-2 bg-background-light dark:bg-background-dark">
            <div class="flex flex-col gap-2">
                <div class="flex justify-between items-end mb-1">
                    <span class="text-sm font-bold text-primary dark:text-teal-400">ขั้นที่ 1</span>
                    <span class="text-xs font-medium text-text-secondary">1 จาก 3</span>
                </div>
                <div class="flex w-full gap-2 h-1.5">
                    <div class="h-full w-1/3 rounded-full bg-primary shadow-[0_0_10px_rgba(0,108,117,0.4)]"></div>
                    <div class="h-full w-1/3 rounded-full bg-border-light dark:bg-border-dark"></div>
                    <div class="h-full w-1/3 rounded-full bg-border-light dark:bg-border-dark"></div>
                </div>
            </div>
        </div>

        <main class="flex-1 overflow-y-auto no-scrollbar p-6 pt-2 pb-32">
            <h1 class="text-2xl font-bold text-text-main dark:text-white mb-6 mt-2">รายละเอียดสินค้า</h1>
            
            <div class="bg-surface-light dark:bg-surface-dark rounded-3xl p-5 shadow-soft border border-white/50 dark:border-border-dark flex flex-col gap-6">
                
                <div class="flex flex-col gap-2 group">
                    <label class="text-sm font-semibold text-text-main dark:text-gray-200 flex items-center gap-2">
                        ชื่อสินค้า <span class="h-1.5 w-1.5 rounded-full bg-red-400"></span>
                    </label>
                    <div class="relative flex items-center">
                        <input id="product_name" class="peer w-full h-14 rounded-2xl border border-border-light dark:border-border-dark bg-gray-50/50 dark:bg-black/20 px-4 text-base text-text-main dark:text-white placeholder:text-text-secondary/60 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all" placeholder="เช่น iPhone 13 Pro Max" type="text"/>
                        <div class="absolute right-4 text-text-secondary opacity-0 peer-focus:opacity-100 transition-opacity">
                            <span class="material-symbols-outlined text-[20px]">edit</span>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col sm:flex-row gap-5">
                    <div class="flex-1 flex flex-col gap-2">
                        <label class="text-sm font-semibold text-text-main dark:text-gray-200 flex items-center gap-2">
                            ราคา <span class="h-1.5 w-1.5 rounded-full bg-red-400"></span>
                        </label>
                        <div class="relative">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 flex items-center justify-center text-primary font-bold">฿</div>
                            <input id="price" class="w-full h-14 rounded-2xl border border-border-light dark:border-border-dark bg-gray-50/50 dark:bg-black/20 pl-10 pr-4 text-base font-medium text-text-main dark:text-white placeholder:text-text-secondary/60 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all" placeholder="0.00" type="number"/>
                        </div>
                    </div>
                    <div class="flex-1 flex flex-col gap-2">
                        <label class="text-sm font-semibold text-text-main dark:text-gray-200 flex items-center gap-2">
                            เบอร์โทรศัพท์ <span class="h-1.5 w-1.5 rounded-full bg-red-400"></span>
                        </label>
                        <div class="relative">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-text-secondary">
                                <span class="material-symbols-outlined text-[20px]">call</span>
                            </div>
                            <input id="phone_number" class="w-full h-14 rounded-2xl border border-border-light dark:border-border-dark bg-gray-50/50 dark:bg-black/20 pl-11 pr-4 text-base text-text-main dark:text-white placeholder:text-text-secondary/60 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all" placeholder="08x-xxx-xxxx" type="tel"/>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col gap-2">
                    <label class="text-sm font-semibold text-text-main dark:text-gray-200 flex items-center justify-between">
                        รายละเอียดเพิ่มเติม <span class="text-xs font-normal text-text-secondary">ไม่บังคับ</span>
                    </label>
                    <textarea id="description" class="w-full min-h-[140px] resize-none rounded-2xl border border-border-light dark:border-border-dark bg-gray-50/50 dark:bg-black/20 p-4 text-base text-text-main dark:text-white placeholder:text-text-secondary/60 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all" placeholder="ระบุสภาพสินค้า, การรับประกัน หรือข้อมูลอื่นๆ ที่จำเป็น..."></textarea>
                </div>

                <button class="group relative flex w-full items-center justify-center gap-3 rounded-2xl border-2 border-dashed border-border-light dark:border-border-dark bg-gray-50/30 dark:bg-white/5 py-4 transition-all hover:border-primary/50 hover:bg-primary/5">
                    <div class="flex h-10 w-10 items-center justify-center rounded-full bg-white dark:bg-surface-dark shadow-sm ring-1 ring-border-light dark:ring-border-dark group-hover:scale-110 transition-transform">
                        <span class="material-symbols-outlined text-primary">add_a_photo</span>
                    </div>
                    <span class="text-sm font-medium text-text-secondary group-hover:text-primary transition-colors">เพิ่มรูปภาพสินค้า</span>
                </button>
            </div>

            <div class="mt-8 flex items-center justify-center gap-2 opacity-60">
                <span class="material-symbols-outlined text-[18px] text-primary">verified_user</span>
                <p class="text-xs text-text-secondary">Depayit Verified • ปลอดภัยไร้โกง</p>
            </div>
            <div class="h-10"></div>
        </main>

        <div class="absolute bottom-0 left-0 w-full bg-white/80 dark:bg-background-dark/80 backdrop-blur-xl border-t border-border-light/50 dark:border-border-dark px-6 py-5 z-20">
            <button onclick="submitForm()" class="relative w-full overflow-hidden rounded-full bg-primary py-4 text-white shadow-lg shadow-primary/25 transition-all hover:bg-primary-dark hover:shadow-primary/40 active:scale-[0.98]">
                <div class="flex items-center justify-center gap-2">
                    <span class="text-lg font-bold">ดำเนินการต่อ</span>
                    <span class="material-symbols-outlined text-[20px]">arrow_forward</span>
                </div>
            </button>
            <div class="mt-3 flex items-center justify-center gap-1.5">
                <span class="material-symbols-outlined text-[14px] text-text-secondary">lock</span>
                <p class="text-[11px] font-medium text-text-secondary">ข้อมูลของคุณถูกเข้ารหัสด้วยความปลอดภัยสูงสุด (256-bit SSL)</p>
            </div>
        </div>
    </div>

    <script>
        async function submitForm() {
            // 1. Get Values
            const product = document.getElementById('product_name').value;
            const price = document.getElementById('price').value;
            const phone = document.getElementById('phone_number').value;
            const desc = document.getElementById('description').value;

            // 2. Simple Validation
            if (!product || !price || !phone) {
                alert("กรุณากรอกข้อมูลสำคัญให้ครบถ้วน");
                return;
            }

            // 3. Send to Backend (Relative Path)
            try {
                // เปลี่ยนเป็น Relative Path ตามที่ขอครับ
                const res = await fetch('/api/transactions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        product_name: product,
                        price: parseFloat(price),
                        phone_number: phone,
                        description: desc
                    })
                });

                const data = await res.json();

                if (res.ok) {
                    alert('สร้างรายการสำเร็จ! กำลังไปหน้าถัดไป...');
                    // Redirect to next page with TXID and PIN
                    window.location.href = `Transaction-Link-02.html?txid=${data.tx_id}&pin=${data.pin}`;
                } else {
                    alert('เกิดข้อผิดพลาด: ' + JSON.stringify(data));
                }
            } catch (e) {
                console.error(e);
                alert('เชื่อมต่อ Server ไม่ได้ (ลองตรวจสอบว่ารัน backend หรือยัง)');
            }
        }
    </script>
</body>
</html>